<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Female Profiles - Admin Panel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="admin-styles.css">
    <style>
        .profile-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
            margin-bottom: 16px;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ec4899, #be185d);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: bold;
            overflow: hidden;
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .profile-email {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .profile-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #9ca3af;
        }

        .profile-actions {
            display: flex;
            gap: 8px;
        }

        .profile-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .detail-label {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .detail-value {
            font-size: 14px;
            color: #1f2937;
        }

        .approval-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .approval-status.approved {
            background: #dcfce7;
            color: #16a34a;
        }

        .approval-status.rejected {
            background: #fee2e2;
            color: #dc2626;
        }

        .approval-status.pending {
            background: #fef3c7;
            color: #d97706;
        }

        .media-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }

        .media-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .media-item {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: #f3f4f6;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .media-item img,
        .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .media-item:hover .media-overlay {
            opacity: 1;
        }

        .media-action {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 6px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .media-action:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .modal-dialog {
            background: white;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #6b7280;
            cursor: pointer;
        }

        .view-mode-toggle {
            display: flex;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 4px;
            gap: 4px;
        }

        .view-mode-btn {
            padding: 8px 12px;
            background: none;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #6b7280;
            transition: all 0.2s ease;
        }

        .view-mode-btn.active {
            background: white;
            color: #1f2937;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .profiles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }

        .profiles-list .profile-card {
            margin-bottom: 16px;
        }

        @media (max-width: 768px) {
            .profiles-grid {
                grid-template-columns: 1fr;
            }
            
            .profile-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .profile-actions {
                width: 100%;
                justify-content: stretch;
            }
            
            .profile-actions .btn {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <div class="admin-layout">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-shield-alt"></i>
                    <span>Hume Admin</span>
                </div>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="/admin-dashboard.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="/admin-female-profiles.html" class="nav-link">
                        <i class="fas fa-female"></i>
                        <span>Female Profiles</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin-male-profiles.html" class="nav-link">
                        <i class="fas fa-male"></i>
                        <span>Male Profiles</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin-interests.html" class="nav-link">
                        <i class="fas fa-tags"></i>
                        <span>Interests</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin-meet-requests.html" class="nav-link">
                        <i class="fas fa-video"></i>
                        <span>Meet Requests</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/admin-management.html" class="nav-link">
                        <i class="fas fa-user-cog"></i>
                        <span>Admin Management</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-footer">
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <button class="sidebar-toggle" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="page-title">Female Profiles <span id="profilesCount">(0)</span></h1>
                </div>
                <div class="top-bar-right">
                    <div class="admin-info">
                        <div class="admin-details">
                            <span class="admin-name" id="adminName">Loading...</span>
                            <span class="admin-role" id="adminRole">Admin</span>
                        </div>
                        <div class="admin-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Filters -->
                <div class="filters-section">
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label class="filter-label">Search</label>
                            <input 
                                type="text" 
                                id="searchInput" 
                                class="filter-input" 
                                placeholder="Search by name or email..."
                                oninput="handleSearch()"
                            >
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Approval Status</label>
                            <select id="approvalFilter" class="filter-select" onchange="handleFilter()">
                                <option value="">All Statuses</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                                <option value="pending">Pending Review</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Age Range</label>
                            <select id="ageFilter" class="filter-select" onchange="handleFilter()">
                                <option value="">All Ages</option>
                                <option value="18-25">18-25</option>
                                <option value="26-35">26-35</option>
                                <option value="36-45">36-45</option>
                                <option value="46+">46+</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Date Joined</label>
                            <select id="dateFilter" class="filter-select" onchange="handleFilter()">
                                <option value="">All Time</option>
                                <option value="today">Today</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="year">This Year</option>
                            </select>
                        </div>
                    </div>
                    <div class="filters-actions">
                        <button class="btn btn-secondary" onclick="clearFilters()">
                            <i class="fas fa-times"></i>
                            Clear Filters
                        </button>
                        <button class="btn btn-primary" onclick="exportProfiles()">
                            <i class="fas fa-download"></i>
                            Export Data
                        </button>
                    </div>
                </div>

                <!-- Profiles Container -->
                <div id="profilesContainer" class="profiles-grid">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading female profiles...</p>
                    </div>
                </div>

                <!-- Pagination -->
                <div id="paginationContainer" style="margin-top: 24px;"></div>
            </div>
        </main>
    </div>

    <script src="admin-common.js"></script>
    <script>
        let profiles = [];
        let filteredProfiles = [];
        let currentPage = 1;
        let itemsPerPage = 12;
        let viewMode = 'list';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadProfiles();
        });

        async function loadProfiles() {
            const container = document.getElementById('profilesContainer');
            showTableLoading(container, 'Loading female profiles...');

            // Always use real data

            try {
                const { data, error } = await window.supabaseClient
                    .from('user_profiles')
                    .select(`
                        id,
                        user_id,
                        first_name,
                        last_name,
                        gender,
                        date_of_birth,
                        country,
                        city,
                        height_cm,
                        weight_kg,
                        eye_color,
                        hair_color,
                        skin_tone,
                        body_type,
                        education_level,
                        occupation,
                        work_status,
                        housing_type,
                        living_condition,
                        phone_code,
                        mobile_number,
                        languages_spoken,
                        profile_picture_url,
                        about_me,
                        is_public,
                        admin_approved,
                        created_at,
                        updated_at
                    `)
                    .eq('gender', 'female')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                profiles = data || [];
                filteredProfiles = [...profiles];
                renderProfiles();

            } catch (error) {
                console.error('Error loading profiles:', error);
                showTableError(container, 'Error loading female profiles');
                
                // Fallback to mock data on error
                const mockProfiles = [
                    {
                        id: 'demo-f1',
                        first_name: 'Emma',
                        last_name: 'Johnson',
                        email: 'emma.j@example.com',
                        age: 28,
                        gender: 'female',
                        bio: 'Passionate about art, travel, and meeting new people. Love hiking and outdoor adventures.',
                        location: 'New York, NY',
                        admin_approved: true,
                        created_at: new Date(Date.now() - 5 * 24 * 3600000).toISOString(),
                        updated_at: new Date(Date.now() - 2 * 24 * 3600000).toISOString()
                    },
                    {
                        id: 'demo-f2',
                        first_name: 'Sophia',
                        last_name: 'Williams',
                        email: 'sophia.w@example.com',
                        age: 24,
                        gender: 'female',
                        bio: 'Medical student with a passion for helping others. Enjoy reading and quiet evenings.',
                        location: 'Boston, MA',
                        admin_approved: true,
                        created_at: new Date(Date.now() - 10 * 24 * 3600000).toISOString(),
                        updated_at: new Date(Date.now() - 8 * 24 * 3600000).toISOString()
                    }
                ];
                
                profiles = mockProfiles;
                filteredProfiles = [...profiles];
                renderProfiles();
            }
        }

        function renderProfiles() {
            const container = document.getElementById('profilesContainer');
            
            if (filteredProfiles.length === 0) {
                showTableEmpty(container, 'No female profiles found');
                return;
            }

            // Calculate pagination
            const totalPages = Math.ceil(filteredProfiles.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentProfiles = filteredProfiles.slice(startIndex, endIndex);

            // Force list view
            container.className = 'profiles-list';

            // Render profiles
            container.innerHTML = currentProfiles.map(profile => `
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            ${profile.profile_picture_url ? 
                                `<img src="${profile.profile_picture_url}" alt="${profile.first_name}"
                                      onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                 <div class="avatar-fallback" style="display:none;">${getInitials(profile.first_name, profile.last_name)}</div>`
                                : getInitials(profile.first_name, profile.last_name)
                            }
                        </div>
                        <div class="profile-info">
                            <div class="profile-name">
                                ${profile.first_name} ${profile.last_name}
                            </div>
                            <div class="profile-email">${profile.phone_code || ''}${profile.mobile_number || 'No phone'}</div>
                            <div class="profile-meta">
                                <span>Age: ${calculateAge(profile.date_of_birth) || 'N/A'}</span>
                                <span>Joined: ${formatDate(profile.created_at)}</span>
                            </div>
                        </div>
                        <div class="profile-actions">
                            ${getApprovalStatus(profile.admin_approved)}
                            <button class="btn btn-secondary btn-sm" onclick="viewProfile('${profile.id}')">
                                <i class="fas fa-eye"></i>
                                View
                            </button>
                        </div>
                    </div>
                    
                    <div class="profile-details">
                        <div class="detail-item">
                            <div class="detail-label">Location</div>
                            <div class="detail-value">${profile.city || 'Not specified'}, ${profile.country || ''}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Education</div>
                            <div class="detail-value">${profile.education_level || 'Not specified'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Occupation</div>
                            <div class="detail-value">${profile.occupation || 'Not specified'}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">About</div>
                            <div class="detail-value">${truncateText(profile.about_me || 'No bio available', 100)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Last Updated</div>
                            <div class="detail-value">${formatTimeAgo(profile.updated_at)}</div>
                        </div>
                    </div>

                    <div class="profile-actions" style="margin-top: 16px; gap: 8px;">
                        ${profile.admin_approved === null ? `
                            <button class="btn btn-primary btn-sm" onclick="approveProfile('${profile.id}')">
                                <i class="fas fa-check"></i>
                                Approve
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="rejectProfile('${profile.id}')">
                                <i class="fas fa-times"></i>
                                Reject
                            </button>
                        ` : ''}
                        <button class="btn btn-secondary btn-sm" onclick="viewMedia('${profile.id}')">
                            <i class="fas fa-images"></i>
                            Media
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteProfile('${profile.id}')">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');

            // Update count and render pagination
            const countEl = document.getElementById('profilesCount');
            if (countEl) countEl.textContent = `(${filteredProfiles.length})`;
            renderPagination(totalPages);
        }

        function renderPagination(totalPages) {
            const container = document.getElementById('paginationContainer');
            
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }

            const pagination = createPagination(currentPage, totalPages, (page) => {
                currentPage = page;
                renderProfiles();
            });

            container.innerHTML = '';
            container.appendChild(pagination);
        }

        function getInitials(firstName, lastName) {
            const first = firstName ? firstName.charAt(0).toUpperCase() : '';
            const last = lastName ? lastName.charAt(0).toUpperCase() : '';
            return first + last || '?';
        }

        function getApprovalStatus(status) {
            if (status === true) {
                return '<span class="approval-status approved"><i class="fas fa-check"></i> Approved</span>';
            } else if (status === false) {
                return '<span class="approval-status rejected"><i class="fas fa-times"></i> Rejected</span>';
            } else {
                return '<span class="approval-status pending"><i class="fas fa-clock"></i> Pending</span>';
            }
        }

        function truncateText(text, maxLength) {
            if (!text || text.length <= maxLength) return text;
            return text.substring(0, maxLength) + '...';
        }

        function calculateAge(dateOfBirth) {
            if (!dateOfBirth) return null;
            const today = new Date();
            const birthDate = new Date(dateOfBirth);
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
        }

        async function approveProfile(profileId) {
            try {
                // Always use real data
                
                // Real mode
                const { error } = await window.supabaseClient
                    .from('user_profiles')
                    .update({ admin_approved: true })
                    .eq('id', profileId);

                if (error) throw error;

                showNotification('Profile approved successfully', 'success');
                loadProfiles();
            } catch (error) {
                console.error('Error approving profile:', error);
                showNotification('Error approving profile', 'error');
            }
        }

        async function rejectProfile(profileId) {
            try {
                // Always use real data
                
                // Real mode
                const { error } = await window.supabaseClient
                    .from('user_profiles')
                    .update({ admin_approved: false })
                    .eq('id', profileId);

                if (error) throw error;

                showNotification('Profile rejected', 'success');
                loadProfiles();
            } catch (error) {
                console.error('Error rejecting profile:', error);
                showNotification('Error rejecting profile', 'error');
            }
        }

        function deleteProfile(profileId) {
            confirmAction(
                'Are you sure you want to delete this profile? This action cannot be undone.',
                async () => {
                    try {
                        // Always use real data
                        
                        // Real mode
                        const { error } = await supabase
                            .from('user_profiles')
                            .delete()
                            .eq('id', profileId);

                        if (error) throw error;

                        showNotification('Profile deleted successfully', 'success');
                        loadProfiles();
                    } catch (error) {
                        console.error('Error deleting profile:', error);
                        showNotification('Error deleting profile', 'error');
                    }
                }
            );
        }

        function viewProfile(profileId) {
            // Find profile
            const profile = profiles.find(p => p.id === profileId);
            if (!profile) return;

            // Create modal
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-dialog">
                    <div class="modal-header">
                        <h3>${profile.first_name} ${profile.last_name}</h3>
                        <button class="close-btn" onclick="this.closest('.modal-overlay').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="profile-details">
                            <div class="detail-item">
                                <div class="detail-label">Email</div>
                                <div class="detail-value">${profile.email}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Age</div>
                                <div class="detail-value">${profile.age || 'Not specified'}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Location</div>
                                <div class="detail-value">${profile.location || 'Not specified'}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Bio</div>
                                <div class="detail-value">${profile.bio || 'No bio available'}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Approval Status</div>
                                <div class="detail-value">${getApprovalStatus(profile.admin_approved)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Joined</div>
                                <div class="detail-value">${formatDateTime(profile.created_at)}</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Last Updated</div>
                                <div class="detail-value">${formatDateTime(profile.updated_at)}</div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        ${profile.admin_approved === null ? `
                            <button class="btn btn-primary" onclick="approveProfile('${profile.id}'); this.closest('.modal-overlay').remove();">
                                <i class="fas fa-check"></i>
                                Approve
                            </button>
                            <button class="btn btn-danger" onclick="rejectProfile('${profile.id}'); this.closest('.modal-overlay').remove();">
                                <i class="fas fa-times"></i>
                                Reject
                            </button>
                        ` : ''}
                        <button class="btn btn-secondary" onclick="this.closest('.modal-overlay').remove()">
                            Close
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function viewMedia(profileId) {
            // This would load and display media for the profile
            showNotification('Media viewer coming soon', 'info');
        }

        // Removed grid/list toggle; list view enforced

        const handleSearch = debounce(() => {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            applyFilters();
        }, 300);

        function handleFilter() {
            applyFilters();
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const approvalFilter = document.getElementById('approvalFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;

            filteredProfiles = profiles.filter(profile => {
                // Search filter
                const matchesSearch = !searchTerm || 
                    profile.first_name.toLowerCase().includes(searchTerm) ||
                    profile.last_name.toLowerCase().includes(searchTerm) ||
                    profile.email.toLowerCase().includes(searchTerm);

                // Approval filter
                let matchesApproval = true;
                if (approvalFilter === 'approved') {
                    matchesApproval = profile.admin_approved === true;
                } else if (approvalFilter === 'rejected') {
                    matchesApproval = profile.admin_approved === false;
                } else if (approvalFilter === 'pending') {
                    matchesApproval = profile.admin_approved === null;
                }

                // Age filter
                let matchesAge = true;
                if (ageFilter && profile.age) {
                    const age = parseInt(profile.age);
                    switch (ageFilter) {
                        case '18-25':
                            matchesAge = age >= 18 && age <= 25;
                            break;
                        case '26-35':
                            matchesAge = age >= 26 && age <= 35;
                            break;
                        case '36-45':
                            matchesAge = age >= 36 && age <= 45;
                            break;
                        case '46+':
                            matchesAge = age >= 46;
                            break;
                    }
                }

                // Date filter
                let matchesDate = true;
                if (dateFilter) {
                    const profileDate = new Date(profile.created_at);
                    const now = new Date();
                    
                    switch (dateFilter) {
                        case 'today':
                            matchesDate = profileDate.toDateString() === now.toDateString();
                            break;
                        case 'week':
                            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                            matchesDate = profileDate >= weekAgo;
                            break;
                        case 'month':
                            const monthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
                            matchesDate = profileDate >= monthAgo;
                            break;
                        case 'year':
                            const yearAgo = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());
                            matchesDate = profileDate >= yearAgo;
                            break;
                    }
                }

                return matchesSearch && matchesApproval && matchesAge && matchesDate;
            });

            currentPage = 1;
            renderProfiles();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('approvalFilter').value = '';
            document.getElementById('ageFilter').value = '';
            document.getElementById('dateFilter').value = '';
            
            filteredProfiles = [...profiles];
            currentPage = 1;
            renderProfiles();
        }

        function exportProfiles() {
            if (filteredProfiles.length === 0) {
                showNotification('No profiles to export', 'warning');
                return;
            }

            const exportData = filteredProfiles.map(profile => ({
                'First Name': profile.first_name,
                'Last Name': profile.last_name,
                'Email': profile.email,
                'Age': profile.age || '',
                'Location': profile.location || '',
                'Bio': profile.bio || '',
                'Approval Status': profile.admin_approved === true ? 'Approved' : 
                                  profile.admin_approved === false ? 'Rejected' : 'Pending',
                'Joined Date': formatDate(profile.created_at),
                'Last Updated': formatDate(profile.updated_at)
            }));

            exportToCSV(exportData, `female-profiles-${new Date().toISOString().split('T')[0]}.csv`);
        }
    </script>
</body>
</html>
